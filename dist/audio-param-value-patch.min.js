// webkitaudiocontext-patch - created by Lajos Meszaros <m_lajos@hotmail.com> - MIT licence - last built on 2017-08-03
function getLinearRampToValueAtTime(e,t,r,a,i){return e<=a?t:i<=e?r:t+(e-a)/(i-a)*(r-t)}function getExponentialRampToValueAtTime(e,t,r,a,i){if(e<=a)return t;if(i<=e)return r;if(t===r)return t;var o=(e-a)/(i-a);return t>0&&r>0||t<0&&r<0?t*Math.pow(r/t,o):0}function getTargetValueAtTime(e,t,r,a,i){return e<=a?t:r+(t-r)*Math.exp((a-e)/i)}function getValueCurveAtTime(e,t,r,a){if(0===t.length)return 0;var i=(e-r)/a*(t.length-1),o=0|i,n=o+1;if(t.length<=n)return t[t.length-1];var u=t[o];return u+i%1*(t[n]-u)}function findIndex(e,t,r){return 0===e.length||r(t,e[0])<0?[void 0,0]:r(t,e[e.length-1])>0?[e.length-1,void 0]:modifiedBinarySearch(e,0,e.length-1,t,r)}function modifiedBinarySearch(e,t,r,a,i){if(t>r)return[r,void 0];var o=Math.floor((t+r)/2),n=e[o];return i(n,a)<0&&e[o+1]&&i(e[o+1],a)>0?[o,o+1]:i(n,a)>0?modifiedBinarySearch(e,t,o-1,a,i):i(n,a)<0?modifiedBinarySearch(e,o+1,r,a,i):[o]}var firefoxVersion=!1;try{firefoxVersion=navigator.userAgent.match(/Firefox\/([\d.]+)/)[1].split(".").map(function(e){return parseInt(e)})}catch(e){}if(!1!==firefoxVersion){AudioParam.prototype._events=[],AudioParam.prototype._ctx=null;var oldSetValueAtTime=AudioParam.prototype.setValueAtTime;AudioParam.prototype.setValueAtTime=function(e,t){var r=Array.from(arguments);return null!==this._ctx&&this._insertEvent({type:"setValueAtTime",time:t,value:e,args:r}),oldSetValueAtTime.apply(this,r)};var oldLinearRampToValueAtTime=AudioParam.prototype.linearRampToValueAtTime;AudioParam.prototype.linearRampToValueAtTime=function(e,t){var r=Array.from(arguments);return null!==this._ctx&&this._insertEvent({type:"linearRampToValueAtTime",time:t,value:e,args:r}),oldLinearRampToValueAtTime.apply(this,r)};var oldExponentialRampToValueAtTime=AudioParam.prototype.exponentialRampToValueAtTime;AudioParam.prototype.exponentialRampToValueAtTime=function(e,t){var r=Array.from(arguments);return null!==this._ctx&&this._insertEvent({type:"exponentialRampToValueAtTime",time:t,value:e,args:r}),oldExponentialRampToValueAtTime.apply(this,r)};var oldSetTargetAtTime=AudioParam.prototype.setTargetAtTime;AudioParam.prototype.setTargetAtTime=function(e,t,r){var a=Array.from(arguments);return null!==this._ctx&&this._insertEvent({type:"setTargetAtTime",time:t,value:e,timeConstant:r,args:a}),oldSetTargetAtTime.apply(this,a)};var oldSetValueCurveAtTime=AudioParam.prototype.setValueCurveAtTime;AudioParam.prototype.setValueCurveAtTime=function(e,t,r){var a=Array.from(arguments);return null!==this._ctx&&this._insertEvent({type:"setValueCurveAtTime",time:t,curve:e,duration:r,args:a}),oldSetValueCurveAtTime.apply(this,a)};var oldCancelScheduledValues=AudioParam.prototype.cancelScheduledValues;AudioParam.prototype.cancelScheduledValues=function(e){return null!==this._ctx&&(this._events=this._events.filter(function(t){return t.time<e})),oldCancelScheduledValues.apply(this,Array.from(arguments))},AudioParam.prototype._insertEvent=function(e){var t,r,a=e.time,i=this._events=JSON.parse(JSON.stringify(this._events)),o=0;if(0===i.length||i[i.length-1].time<a)i.push(e);else{for(t=0,r=i.length;t<r;t++){if(i[t].time===a&&i[t].type===e.type){o=1;break}if(a<i[t].time)break}i.splice(t,o,e)}},AudioParam.prototype._getValueAtTime=function(e){var t,r,a,i,o,n=this._events,u=this.defaultValue,l=findIndex(n,{time:e},function(e,t){return e.time-t.time}),m=l[0],p=l[1];for(1===l.length||void 0!==m?t=m:void 0!==p&&(t=p),t=Math.max(0,t-1),r=n.length;t<r&&(a=n[t],i=n[t+1],o=Math.min(e,i?i.time:e),!(e<a.time));t++){switch(a.type){case"setValueAtTime":case"linearRampToValueAtTime":case"exponentialRampToValueAtTime":u=a.value;break;case"setTargetAtTime":u=getTargetValueAtTime(o,u,a.value,a.time,a.timeConstant);break;case"setValueCurveAtTime":u=getValueCurveAtTime(o,a.curve,a.time,a.duration)}if(i)switch(i.type){case"linearRampToValueAtTime":u=getLinearRampToValueAtTime(o,u,i.value,a.time,i.time);break;case"exponentialRampToValueAtTime":u=getExponentialRampToValueAtTime(o,u,i.value,a.time,i.time)}}return u};var descriptor=Object.getOwnPropertyDescriptor(AudioParam.prototype,"value"),oldSet=descriptor.set;descriptor.set=function(e){console.log("set"),null===this._ctx?oldSet.apply(this,Array.from(arguments)):this.setValueAtTime(e,this._ctx.currentTime)};var oldGet=descriptor.get;descriptor.get=function(){return null===this._ctx?oldGet.apply(this,Array.from(arguments)):this._getValueAtTime(this._ctx.currentTime)},Object.defineProperty(AudioParam.prototype,"value",descriptor);var oldCreateGain=AudioContext.prototype.createGain;AudioContext.prototype.createGain=function(){var e=oldCreateGain.apply(this,Array.from(arguments));return e.gain._ctx=this,e};var oldCreateOscillator=AudioContext.prototype.createOscillator;AudioContext.prototype.createOscillator=function(){var e=oldCreateOscillator.apply(this,Array.from(arguments));return e.frequency._ctx=this,e.detune._ctx=this,e}}
//# sourceMappingURL=audio-param-value-patch.min.js.map
